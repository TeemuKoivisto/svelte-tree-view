import"./NZTpNUN0.js";import{S as _e,B as M,D as U,O as T,Q as B,E,P,a as m,H as _,C as K,T as V,G as S,U as I,F as q,V as X,R as Y,r as Z,aj as W,at as ye,au as F,g as j,y as be,u as L,k as we}from"./C5ZeV78G.js";import{i as k,c as Ne,b as Oe,r as Ce}from"./D4jLHckW.js";import{e as R,d as $,f as ee,i as te,k as xe}from"./DwW8aOf1.js";import{a as re,s as A}from"./4YIckaYW.js";import{o as je}from"./Ba2SDbxX.js";var Te=U("<button>â–¶</button>"),Se=U('<button class="log-copy-button svelte-ngcjq5">log</button>'),ke=U('<button class="log-copy-button svelte-ngcjq5">copy</button>'),Ve=U('<li class="row svelte-ngcjq5"><ul class="svelte-ngcjq5"></ul></li>'),Ie=U('<li><!> <div role="presentation"><!></div> <div role="presentation"><!></div> <div class="buttons svelte-ngcjq5"><!> <!></div></li> <!>',1);function ze(r,e){M(e,!0);const[d,t]=re(),a=()=>A(o,"$propsObj",d),{propsStore:{props:o,formatValue:c}}=e.getTreeContext();let s=V(()=>e.node.children.length>0),l=V(()=>!e.node.collapsed&&m(s)),h=V(()=>c(e.node.getValue(),e.node));var n=Ie(),p=T(n);let f;var O=E(p);{var C=i=>{var u=Te();u.__click=function(...y){e.handleToggleCollapse?.apply(this,y)},P(()=>R(u,1,`arrow-btn ${e.node.collapsed?"collapsed":""}`,"svelte-ngcjq5")),_(i,u)};k(O,i=>{m(s)&&i(C)})}var b=B(O,2);let g;b.__click=function(...i){e.handleToggleCollapse?.apply(this,i)};var v=E(b);{var w=i=>{var u=I(),y=T(u);q(y,()=>e.key,()=>e.node),_(i,u)},x=i=>{var u=X();P(()=>Y(u,`${e.node.key??""}:`)),_(i,u)};k(v,i=>{e.key?i(w):i(x,!1)})}S(b);var N=B(b,2);let G;N.__click=function(...i){e.handleToggleCollapse?.apply(this,i)};var ae=E(N);{var se=i=>{var u=I(),y=T(u);q(y,()=>e.value,()=>e.node),_(i,u)},le=i=>{var u=X();P(()=>Y(u,m(h))),_(i,u)};k(ae,i=>{e.value?i(se):i(le,!1)})}S(N);var H=B(N,2),J=E(H);{var ie=i=>{var u=Se();u.__click=function(...y){e.handleLogNode?.apply(this,y)},_(i,u)};k(J,i=>{a().showLogButton&&i(ie)})}var ce=B(J,2);{var de=i=>{var u=ke();u.__click=function(...y){e.handleCopyNodeToClipboard?.apply(this,y)},_(i,u)};k(ce,i=>{a().showCopyButton&&i(de)})}S(H),S(p);var ue=B(p,2);{var fe=i=>{var u=Ve(),y=E(u);ee(y,21,()=>e.node.children,te,(ve,he)=>{var Q=I(),pe=T(Q);Ne(pe,()=>e.TreeViewNode,(ge,me)=>{me(ge,{get id(){return m(he)}})}),_(ve,Q)}),S(y),S(u),_(i,u)};k(ue,i=>{m(l)&&i(fe)})}P((i,u,y)=>{f=R(p,1,"row svelte-ngcjq5",null,f,i),$(p,"data-tree-id",e.node.id),g=R(b,1,"node-key svelte-ngcjq5",null,g,u),G=R(N,1,"node-value svelte-ngcjq5",null,G,y),$(N,"data-type",e.node.type)},[()=>({collapsed:e.node.collapsed&&m(s)}),()=>({"has-children":m(s),"p-left":!m(s)}),()=>({expanded:!e.node.collapsed&&m(s),"has-children":m(s)})]),_(r,n),K(),t()}_e(["click"]);function oe(r,e){M(e,!0);const[d,t]=re(),a=()=>A(l,"$rootElementStore",d),o=()=>A(h,"$propsObj",d),{treeStore:c,propsStore:s,rootElementStore:l}=Z("svelte-tree-view");let{props:h}=s,n=W(c.treeMap[e.id]),p=V(()=>n&&n.children.length>0),f=V(()=>({node:n,getTreeContext:()=>Z("svelte-tree-view"),TreeViewNode:oe,handleLogNode(){console.info("%c [svelte-tree-view]: Property added to window._node","color: #b8e248"),console.log(n.getValue());try{typeof window<"u"&&(window._node=n.getValue())}catch{console.error("Failed to set _node, window was undefined")}},handleCopyNodeToClipboard(){try{navigator.clipboard.writeText(JSON.stringify(n.getValue()))}catch(b){console.error("Copying node to clipboard failed: ",b)}},handleToggleCollapse(){m(p)?c.toggleCollapse(n.id):n.circularOfId&&(c.expandAllNodesToNode(n.circularOfId),a()?.querySelector(`li[data-tree-id="${n.circularOfId}"]`)?.scrollIntoView())}}));var O=I(),C=T(O);q(C,()=>o().treeNode,()=>m(f)),_(r,O),K(),t()}const Ee=r=>{const e=F(r),d=ye(e,t=>t.recursionOpts);return{props:e,recursionOpts:d,setProps(t){e.set(t)},formatValue(t,a){const{valueFormatter:o}=j(e),c=o?o(t,a):void 0;if(c)return c;switch(a.type){case"array":return`${a.circularOfId?"circular":""} [] ${t.length} items`;case"object":return`${a.circularOfId?"circular":""} {} ${Object.keys(t).length} keys`;case"map":case"set":return`${a.circularOfId?"circular":""} () ${t.size} entries`;case"date":return`${t.toISOString()}`;case"string":return`"${t}"`;case"number":return t;case"boolean":return t?"true":"false";case"symbol":return String(t);default:return a.type}}}},Ue=()=>{const r=F(null);return{set:r.set,subscribe:r.subscribe}};function ne(r,e,d,t,a,o){const c=a?[...a.path,r]:[],s=`[${c.join(",")}]`,l=o[s];return l?(l.key=e,l.getValue=()=>d,l.depth=t,l.type=D(d),l.circularOfId=null,l.children=[],[l,l]):[W({id:s,index:r,key:e,getValue:()=>d,depth:t,collapsed:!0,type:D(d),path:c,parentId:a?a.id:null,circularOfId:null,children:[]}),l]}function D(r){return Array.isArray(r)?"array":r instanceof Map?"map":r instanceof Set?"set":r instanceof Date?"date":r===null?"null":typeof r}function Be(r,e){switch(e){case"array":return r.map((t,a)=>[a.toString(),t]);case"map":return Array.from(r.entries()).map(([t,a],o)=>[`[map entry ${o}]`,{"[key]":t,"[value]":a}]);case"set":return Array.from(r.values()).map((t,a)=>[`[set entry ${a}]`,t]);case"object":return Object.entries(r);default:return[]}}function Pe(r,e,d,t){if(e){if(r.collapsed&&e?.collapsed)return!1;if(t.stopCircularRecursion){if(t.isCircularNode)return t.isCircularNode(r,d);if(r.type==="object"||r.type==="array"){const a=d.get(r.getValue());if(a&&r.id!==a.id)return r.circularOfId=a.id,!1;d.set(r.getValue(),r)}}else return!0}else return!0;return!0}function z(r,e,d,t,a,o,c,s,l,h,n){var p;if(!((p=n.omitKeys)===null||p===void 0)&&p.includes(e)||n.maxDepth&&t>n.maxDepth)return null;const[f,O]=ne(r,e,d,t,o,c);if(a?f.collapsed=!1:O&&!h?f.collapsed=O.collapsed:n.shouldExpandNode&&(f.collapsed=!n.shouldExpandNode(f)),c[f.id]=f,s.delete(f.id),Pe(f,o,l,n)){const C=n.mapChildren&&n.mapChildren(d,D(d),f),b=C??Be(d,D(d)),g=[];for(let v=0;v<b.length;v+=1){const[w,x]=b[v],N=z(v,w,x,t+1,!1,f,c,s,l,h,n);N?g.push(N.id):console.error("recurseObjectProperties produced unexpected null TreeNode for parent",f)}f.children=g}return f}function Re(r,e,d,t){const a=new Set(Object.keys(e)),o=new Map,c=z(-1,"root",r,0,!0,null,e,a,o,t,d);for(const s of a)delete e[s];return{tree:c,iteratedValues:o}}const qe=r=>{const[e]=ne(0,"root",[],0,null,{}),d=F(e),t=W({}),a=F(new Map);return{tree:d,treeMap:t,defaultRootNode:e,update(o,c,s){var l,h;const n=Re(o,t,c,s);n.tree?d.set(n.tree):d.set(e),a.set(n.iteratedValues),(h=(l=j(r.props)).onUpdate)===null||h===void 0||h.call(l,t)},toggleCollapse(o){var c,s;const l=t[o];if(!l){console.warn(`Attempted to collapse non-existent node: ${o}`);return}l.collapsed=!l.collapsed;const h=j(r.recursionOpts);h?this.expandNodeChildren(l,h):(s=(c=j(r.props)).onUpdate)===null||s===void 0||s.call(c,t)},expandNodeChildren(o,c){var s,l;const n=t[o?.parentId||""]||null;if(!n)throw Error("No parent in expandNodeChildren for node: "+o);const p=j(a),f=z(o.index,o.key,o.getValue(),o.depth,!o.collapsed,n,t,new Set,p,!1,c);f&&(t[f.id]=f,t[n.id]=n,a.set(p),(l=(s=j(r.props)).onUpdate)===null||l===void 0||l.call(s,t))},expandAllNodesToNode(o){var c,s;function l(n,p){p&&(n[p.id].collapsed=!1,p.parentId&&l(n,n[p.parentId]))}const h=t;l(h,h[o]),(s=(c=j(r.props)).onUpdate)===null||s===void 0||s.call(c,h)}}};var Fe=U("<ul><!></ul>");function Ge(r,e){M(e,!0);const d=g=>{var v=I(),w=T(v);ee(w,17,()=>m(p),te,(x,N)=>{oe(x,{get id(){return m(N)}})}),_(g,v)},t={maxDepth:16,omitKeys:[],stopCircularRecursion:!1,shouldExpandNode:()=>!1};let a=Ce(e,["$$slots","$$events","$$legacy","data","rootNode","treeNode","theme","showLogButton","showCopyButton","recursionOpts","valueFormatter","onUpdate"]),o={treeNode:e.treeNode,theme:e.theme,showLogButton:e.showLogButton,showCopyButton:e.showCopyButton,recursionOpts:{...t,...e.recursionOpts},valueFormatter:e.valueFormatter,onUpdate:e.onUpdate},c;const s=Ee(o),l=Ue(),h=qe(s),n=V(()=>({...t,...e.recursionOpts})),p=V(()=>h.treeMap["[]"]?.children);be("svelte-tree-view",{propsStore:s,rootElementStore:l,treeStore:h}),je(()=>{l.set(c)}),L(()=>{o={treeNode:e.treeNode,showLogButton:e.showLogButton,showCopyButton:e.showCopyButton,recursionOpts:o.recursionOpts,valueFormatter:e.valueFormatter,onUpdate:e.onUpdate},s.setProps(o)}),L(()=>{const g=j(s.recursionOpts),v={...m(n)},w=e.data,x=g?.shouldExpandNode!==v.shouldExpandNode;we(()=>{h.update(w,v,x),s.setProps(o),o.recursionOpts=v})}),L(()=>{for(const g in e.theme){const v=e.theme[g];c&&g.includes("base")&&v&&c.style.setProperty(`--tree-view-${g}`,v)}});var f=I(),O=T(f);{var C=g=>{var v=I(),w=T(v);q(w,()=>e.rootNode,()=>d),_(g,v)},b=g=>{var v=Fe();xe(v,()=>({...a,class:`${e.class||""} svelte-tree-view`}),void 0,"svelte-auvmwf");var w=E(v);d(w),S(v),Oe(v,x=>c=x,()=>c),_(g,v)};k(O,g=>{e.rootNode?g(C):g(b,!1)})}_(r,f),K()}export{ze as D,Ge as T};
