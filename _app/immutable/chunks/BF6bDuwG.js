import{b as d,d as m,e as h,f as v,g as b,h as _,i as g,j as k,m as y,s as w,n as p,k as M,l as D,q as S,t as x,u as A,v as B,w as F}from"./uS0-QRX5.js";class U{anchor;#t=new Map;#s=new Map;#e=new Map;#i=new Set;#r=!0;constructor(t,s=!0){this.anchor=t,this.#r=s}#n=()=>{var t=d;if(this.#t.has(t)){var s=this.#t.get(t),e=this.#s.get(s);if(e)m(e),this.#i.delete(s);else{var n=this.#e.get(s);n&&(this.#s.set(s,n.effect),this.#e.delete(s),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),e=n.effect)}for(const[r,a]of this.#t){if(this.#t.delete(r),r===t)break;const f=this.#e.get(a);f&&(h(f.effect),this.#e.delete(a))}for(const[r,a]of this.#s){if(r===s||this.#i.has(r))continue;const f=()=>{if(Array.from(this.#t.values()).includes(r)){var u=document.createDocumentFragment();y(a,u),u.append(b()),this.#e.set(r,{effect:a,fragment:u})}else h(a);this.#i.delete(r),this.#s.delete(r)};this.#r||!e?(this.#i.add(r),v(a,f,!1)):f()}}};#a=t=>{this.#t.delete(t);const s=Array.from(this.#t.values());for(const[e,n]of this.#e)s.includes(e)||(h(n.effect),this.#e.delete(e))};ensure(t,s){var e=d,n=w();if(s&&!this.#s.has(t)&&!this.#e.has(t))if(n){var r=document.createDocumentFragment(),a=b();r.append(a),this.#e.set(t,{effect:_(()=>s(a)),fragment:r})}else this.#s.set(t,_(()=>s(this.anchor)));if(this.#t.set(e,t),n){for(const[f,c]of this.#s)f===t?e.unskip_effect(c):e.skip_effect(c);for(const[f,c]of this.#e)f===t?e.unskip_effect(c.effect):e.skip_effect(c.effect);e.oncommit(this.#n),e.ondiscard(this.#a)}else g&&(this.anchor=k),this.#n()}}let o=!1,l=Symbol();function j(i,t,s){const e=s[t]??={store:null,source:M(void 0),unsubscribe:p};if(e.store!==i&&!(l in s))if(e.unsubscribe(),e.store=i??null,i==null)e.source.v=void 0,e.unsubscribe=p;else{var n=!0;e.unsubscribe=D(i,r=>{n?e.source.v=r:B(e.source,r)}),n=!1}return i&&l in s?S(i):x(e.source)}function q(){const i={};function t(){A(()=>{for(var s in i)i[s].unsubscribe();F(i,l,{enumerable:!1,value:!0})})}return[i,t]}function C(i,t,s){return i.set(s),t}function E(i){var t=o;try{return o=!1,[i(),o]}finally{o=t}}export{U as B,q as a,C as b,E as c,j as s};
