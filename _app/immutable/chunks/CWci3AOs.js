import{c as x,a as y,f as k,d as ge,b as T,e as H,t as W,s as Q}from"./DdtxOMYw.js";import{p as F,ah as X,E as S,l as h,J as E,a as J,a1 as $,q as j,ab as ee,ai as Y,aj as ye,k as b,ak as Ne,o as we,x as Z,y as _e,G as V,H as C,F as U,I as M}from"./DgRHvA05.js";import{i as I,b as be,r as Oe,c as Ce}from"./BUXqfv4L.js";import{f as D,l as Ie,e as te,i as re,d as q,c as R}from"./qcKXYCGW.js";import{s as xe,a as Se}from"./BkfkNcBg.js";function oe(t,e){F(e,!0);const r=()=>xe(l,"$viewProps",o),[o,a]=Se(),{treeMap:f,viewProps:l}=X("svelte-tree-view");let n=E(()=>({node:f[e.id],TreeViewNode:oe,getTreeContext:()=>X("svelte-tree-view")}));var u=x(),v=S(u);D(v,()=>r().treeNode,()=>h(n)),y(t,u),J(),a()}function A(t){return Array.isArray(t)?"array":t instanceof RegExp?"regexp":t instanceof Error?"error":t instanceof Map?"map":t instanceof Set?"set":t instanceof Date?"date":t===null?"null":typeof t}function se(t,e,r,o,a,f,l,n){const u=a?[...a.path,t]:[];let v;l&&a?(v=l(r,e,a),n?.has(v)&&(console.error(`[svelte-tree-view]: Duplicate node id "${v}" for key "${e}". Falling back to generated id.`),v=crypto.randomUUID())):v=`[${u.join(",")}]`,n?.add(v);const s=f[v];if(s){const m=s.getValue()===r;return s.key=e,s.getValue=()=>r,s.depth=o,s.type=A(r),s.circularOfId=m?s.circularOfId:null,s.children=[],[s,s]}return[$({id:v,index:t,key:e,getValue:()=>r,depth:o,collapsed:!0,type:A(r),path:u,parentId:a?a.id:null,circularOfId:null,children:[]}),s]}function Ee(t,e){switch(e){case"array":return t.map((o,a)=>[a.toString(),o]);case"map":return Array.from(t.entries()).map(([o,a],f)=>[`[map entry ${f}]`,{"[key]":o,"[value]":a}]);case"set":return Array.from(t.values()).map((o,a)=>[`[set entry ${a}]`,o]);case"object":return Object.entries(t);default:return[]}}function Ve(t,e,r,o){if(e){if(t.collapsed&&e?.collapsed)return!1;if(o.stopCircularRecursion){if(o.isCircularNode)return!o.isCircularNode(t,r);if(t.type==="object"||t.type==="array"){const a=r.get(t.getValue());if(a&&t.id!==a.id)return t.circularOfId=a.id,!1;r.set(t.getValue(),t)}}else return!0}else return!0;return!0}function L(t,e,r,o,a,f,l){if(l.opts.omitKeys?.includes(e)||l.opts.maxDepth&&o>l.opts.maxDepth)return null;const[n,u]=se(t,e,r,o,f,l.treeMap,l.opts.getNodeId,l.usedIds);if(a?n.collapsed=!1:u&&!l.recomputeExpandNode?n.collapsed=u.collapsed:l.opts.shouldExpandNode&&(n.collapsed=!l.opts.shouldExpandNode(n)),l.treeMap[n.id]=n,l.oldIds.delete(n.id),Ve(n,f,l.iteratedValues,l.opts)){const s=(l.opts.mapChildren&&l.opts.mapChildren(r,A(r),n))??Ee(r,A(r)),c=[];for(let m=0;m<s.length;m+=1){const[N,g]=s[m],p=L(m,N,g,o+1,!1,n,l);p&&c.push(p.id)}n.children=c}return n}function ke(t,e,r){const o=r?r(t,e):void 0;if(o)return o;switch(e.type){case"array":return`${e.circularOfId?"circular":""} [] ${t.length} items`;case"object":return`${e.circularOfId?"circular":""} {} ${Object.keys(t).length} keys`;case"map":case"set":return`${e.circularOfId?"circular":""} () ${t.size} entries`;case"date":return`${t.toISOString()}`;case"regexp":return`${t}`;case"error":return`${t.name}: ${t.message}`;case"string":return`"${t}"`;case"number":case"boolean":case"symbol":return String(t);default:return e.type}}function Pe(t,e,r,o,a,f){o.clear();const l=new Set(Object.keys(r));L(e.index,e.key,t,e.depth,!0,null,{treeMap:r,oldIds:l,iteratedValues:o,recomputeExpandNode:f,opts:a,usedIds:new Set});for(const n of l)delete r[n]}function Te(t,e,r,o){const a=e[t.parentId||""];if(!a)throw Error("No parent in expandNodeChildren for node: "+JSON.stringify(t));L(t.index,t.key,t.getValue(),t.depth,!t.collapsed,a,{treeMap:e,oldIds:new Set,iteratedValues:r,recomputeExpandNode:!1,opts:o,usedIds:new Set})}function Me(t,e){function r(o){o&&(e[o.id].collapsed=!1,o.parentId&&r(e[o.parentId]))}r(e[t])}class Re{#e;get treeMap(){return h(this.#e)}set treeMap(e){j(this.#e,e,!0)}#t;get rootNode(){return h(this.#t)}set rootNode(e){j(this.#t,e)}constructor(e){this.defaultRootNode=se(-1,"root",[],0,null,{})[0],this.#e=ee($({[this.defaultRootNode.id]:this.defaultRootNode})),this.#t=E(()=>this.treeMap[this.defaultRootNode.id]),this.rootElement=Y(null),this.iteratedValues=new Map,this.viewProps=Y(e),this.recursionOpts=ye(this.viewProps,r=>r.recursionOpts)}}const Ue=t=>{const e=new Re(t);function r(s){e.viewProps.set(s)}function o(s){e.rootElement.set(s)}function a(s,c){const{valueFormatter:m}=b(e.viewProps);return ke(s,c,m)}function f(s,c,m){Pe(s,e.defaultRootNode,e.treeMap,e.iteratedValues,c,m),b(e.viewProps).onUpdate?.(e.treeMap)}function l(s){const c=e.treeMap[s];if(!c)throw Error("Attempted to collapse non-existent node: "+JSON.stringify(c));c.collapsed=!c.collapsed;const m=b(e.recursionOpts);m?n(c,m):b(e.viewProps).onUpdate?.(e.treeMap)}function n(s,c){Te(s,e.treeMap,e.iteratedValues,c),b(e.viewProps).onUpdate?.(e.treeMap)}function u(s){Me(s,e.treeMap),b(e.viewProps).onUpdate?.(e.treeMap)}function v(s){const c=e.treeMap[s];c.children.length>0?l(s):c.circularOfId&&(u(c.circularOfId),b(e.rootElement)?.querySelector(`[data-tree-node-id="${c.circularOfId}"]`)?.scrollIntoView())}return{get recursionOpts(){return e.recursionOpts},get rootElement(){return e.rootElement},get rootNode(){return e.rootNode},get treeMap(){return e.treeMap},get viewProps(){return e.viewProps},setProps:r,setRootElement:o,formatValue:a,createTree:f,toggleCollapse:l,expandNodeChildren:n,expandAllNodesToNode:u,collapseOrScrollIntoCircularNode:v}};var qe=k("<ul><!></ul>");function Qe(t,e){F(e,!0);const r=g=>{var p=x(),w=S(p);te(w,17,()=>h(v),re,(O,_)=>{oe(O,{get id(){return h(_)}})}),y(g,p)},o={maxDepth:16,omitKeys:[],stopCircularRecursion:!1,shouldExpandNode:()=>!1};let a=Oe(e,["$$slots","$$events","$$legacy","data","rootNode","treeNode","recursionOpts","valueFormatter","onUpdate"]),f={treeNode:e.treeNode,recursionOpts:{...o,...e.recursionOpts},valueFormatter:e.valueFormatter,onUpdate:e.onUpdate},l;const n=Ue(f),u=E(()=>({...o,...e.recursionOpts})),v=E(()=>n.rootNode.children);Ne("svelte-tree-view",n),we(()=>{n.setRootElement(l)}),Z(()=>{f={treeNode:e.treeNode,recursionOpts:f.recursionOpts,valueFormatter:e.valueFormatter,onUpdate:e.onUpdate},n.setProps(f)}),Z(()=>{const g=b(n.recursionOpts),p={...h(u)},w=e.data,O=g?.shouldExpandNode!==p.shouldExpandNode;_e(()=>{n.createTree(w,p,O),n.setProps(f),f.recursionOpts=p})});var s=x(),c=S(s);{var m=g=>{var p=x(),w=S(p);D(w,()=>e.rootNode,()=>r),y(g,p)},N=g=>{var p=qe();Ie(p,()=>({...a,class:`svelte-tree-view ${e.class||""}`,role:"tree"}));var w=V(p);r(w),C(p),be(p,O=>l=O,()=>l),y(g,p)};I(c,g=>{e.rootNode?g(m):g(N,!1)})}y(t,s),J()}function je(t){console.log(t.getValue());try{window._node=t.getValue(),console.info("%c [svelte-tree-view]: Property added to window._node","color: #b8e248")}catch(e){console.error("[svelte-tree-view]: handleLogNode() errored",e)}}function De(t){try{navigator.clipboard.writeText(JSON.stringify(t.getValue()))}catch(e){console.error("[svelte-tree-view]: handleCopyNodeToClipboard() errored",e)}}var Ae=k("<button>â–¶</button>"),Fe=k('<button class="log-copy-button svelte-5sy4qp">log</button>'),Je=k('<button class="log-copy-button svelte-5sy4qp">copy</button>'),Le=k('<ul class="row svelte-5sy4qp" role="group"></ul>'),Be=k('<li role="treeitem"><div class="row-body svelte-5sy4qp"><!> <div role="presentation"><!></div> <div role="presentation"><!></div> <div class="buttons svelte-5sy4qp"><!> <!></div></div> <!></li>');function Xe(t,e){F(e,!0);const{formatValue:r,collapseOrScrollIntoCircularNode:o}=e.getTreeContext();let a=E(()=>e.node.children.length>0),f=E(()=>!e.node.collapsed&&h(a)),l=E(()=>r(e.node.getValue(),e.node)),n=ee(!1);var u=Be();let v;var s=V(u),c=V(s);{var m=i=>{var d=Ae();U(()=>q(d,1,`arrow-btn ${e.node.collapsed?"collapsed":""}`,"svelte-5sy4qp")),T("click",d,()=>o(e.node.id)),H("focus",d,()=>j(n,!0)),H("blur",d,()=>j(n,!1)),y(i,d)};I(c,i=>{h(a)&&i(m)})}var N=M(c,2);let g;var p=V(N);{var w=i=>{var d=x(),P=S(d);D(P,()=>e.keySnippet,()=>e.node),y(i,d)},O=i=>{var d=W();U(()=>Q(d,`${e.node.key??""}:`)),y(i,d)};I(p,i=>{e.keySnippet?i(w):i(O,!1)})}C(N);var _=M(N,2);let B;var ae=V(_);{var ne=i=>{var d=x(),P=S(d);D(P,()=>e.valueSnippet,()=>e.node),y(i,d)},le=i=>{var d=W();U(()=>Q(d,h(l))),y(i,d)};I(ae,i=>{e.valueSnippet?i(ne):i(le,!1)})}C(_);var K=M(_,2),z=V(K);{var ie=i=>{var d=Fe();T("click",d,()=>je(e.node)),y(i,d)};I(z,i=>{e.showLogButton&&i(ie)})}var de=M(z,2);{var ce=i=>{var d=Je();T("click",d,()=>De(e.node)),y(i,d)};I(de,i=>{e.showCopyButton&&i(ce)})}C(K),C(s);var ue=M(s,2);{var fe=i=>{var d=Le();te(d,21,()=>e.node.children,re,(P,pe)=>{var G=x(),ve=S(G);Ce(ve,()=>e.TreeViewNode,(he,me)=>{me(he,{get id(){return h(pe)}})}),y(P,G)}),C(d),y(i,d)};I(ue,i=>{h(f)&&i(fe)})}C(u),U(()=>{v=q(u,1,"row svelte-5sy4qp",null,v,{collapsed:e.node.collapsed&&h(a)}),R(u,"data-tree-node-id",e.node.id),R(u,"aria-expanded",h(a)?e.node.collapsed?"false":"true":void 0),R(u,"aria-level",e.node.depth),R(u,"aria-selected",h(n)?"true":"false"),g=q(N,1,"node-key svelte-5sy4qp",null,g,{"has-children":h(a),"p-left":!h(a)}),B=q(_,1,"node-value svelte-5sy4qp",null,B,{expanded:!e.node.collapsed&&h(a),"has-children":h(a)}),R(_,"data-type",e.node.type)}),T("click",N,()=>o(e.node.id)),T("click",_,()=>o(e.node.id)),y(t,u),J()}ge(["click"]);export{Xe as D,Qe as T,De as a,je as h};
